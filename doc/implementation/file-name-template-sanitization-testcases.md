# TDD繝・せ繝医こ繝ｼ繧ｹ荳隕ｧ・・eature: File Name Template & Sanitization・・

蟇ｾ雎｡讖溯・: `generateFileName` 縺ｨ `sanitizeFileName`

## 蜿ら・蜈・ 螳溯｣・ｼ・rc/utils/fileNameTemplate.ts・峨∬ｨｭ險茨ｼ・ocs/design/novelai-auto-generator/{interfaces.ts, architecture.md, dataflow.md, api-endpoints.md}・・

## 1. 豁｣蟶ｸ邉ｻ繝・せ繝医こ繝ｼ繧ｹ・亥渕譛ｬ逧・↑蜍穂ｽ懶ｼ・

- 繝・せ繝亥錐: 蝓ｺ譛ｬ繝・Φ繝励Ξ繝ｼ繝医・螻暮幕縺瑚｡後∴繧・ - 菴輔ｒ繝・せ繝医☆繧九°: `{date}_{prompt}_{seed}_{idx}` 繧偵さ繝ｳ繝・く繧ｹ繝医〒豁｣縺励￥螻暮幕
  - 譛溷ｾ・＆繧後ｋ蜍穂ｽ・ 縺吶∋縺ｦ縺ｮ繝医・繧ｯ繝ｳ縺梧悄蠕・←縺翫ｊ譁・ｭ怜・縺ｸ螻暮幕縺輔ｌ繧・ - 蜈･蜉帛､: template='{date}_{prompt}_{seed}\_{idx}', ctx={date:'20240914-120000', prompt:'masterpiece, 1girl', seed:'12345', idx:1}
  - 蜈･蜉帙ョ繝ｼ繧ｿ縺ｮ諢丞袖: 莉｣陦ｨ逧・↑蜈ｨ繝医・繧ｯ繝ｳ謖・ｮ・ - 譛溷ｾ・＆繧後ｋ邨先棡: '20240914-120000_masterpiece, 1girl_12345_1'
  - 譛溷ｾ・ｵ先棡縺ｮ逅・罰: 螳溯｣・・ `createTokenMap` 縺ｨ `expandTemplateTokens` 縺ｮ邨仙粋隕丞援
  - 繝・せ繝医・逶ｮ逧・ 繝医・繧ｯ繝ｳ螻暮幕縺ｮ蝓ｺ譛ｬ菫晁ｨｼ
  - 遒ｺ隱阪・繧､繝ｳ繝・ 蛹ｺ蛻・ｊ繝ｻ鬆・ｺ上・謨ｰ蛟､竊呈枚蟄怜・蛹・ - 菫｡鬆ｼ諤ｧ: 泙・亥ｮ溯｣・→interfaces.ts繧堤峩謗･蜿ら・・・
- 繝・せ繝亥錐: 逵∫払繝医・繧ｯ繝ｳ縺ｮ譌｢螳壼､縺碁←逕ｨ縺輔ｌ繧・ - 菴輔ｒ繝・せ繝医☆繧九°: `seed`/`idx` 縺梧悴謖・ｮ壹〒繧ょｱ暮幕繧ｨ繝ｩ繝ｼ縺ｪ縺乗里螳壹′驕ｩ逕ｨ
  - 譛溷ｾ・＆繧後ｋ蜍穂ｽ・ `seed` 遨ｺ譁・ｭ励～idx` 縺ｯ繝・ヵ繧ｩ繝ｫ繝・
  - 蜈･蜉帛､: template='{date}_{prompt}_{seed}\_{idx}', ctx={date:'20240914-120000', prompt:'simple test'}
  - 蜈･蜉帙ョ繝ｼ繧ｿ縺ｮ諢丞袖: 莉ｻ諢上ヨ繝ｼ繧ｯ繝ｳ谺關ｽ
  - 譛溷ｾ・＆繧後ｋ邨先棡: '20240914-120000_simple test\_\_1'
  - 譛溷ｾ・ｵ先棡縺ｮ逅・罰: `idx: String(context.idx || 1)` 縺ｧ譛ｪ謖・ｮ壽凾1縺ｫ
  - 繝・せ繝医・逶ｮ逧・ 谺關ｽ繝輔ぅ繝ｼ繝ｫ繝峨〒縺ｮ鬆大▼諤ｧ
  - 遒ｺ隱阪・繧､繝ｳ繝・ 譛ｪ謖・ｮ壹ヨ繝ｼ繧ｯ繝ｳ縺ｮ譌｢螳壼・逅・ - 菫｡鬆ｼ諤ｧ: 泙・亥ｮ溯｣・盾辣ｧ・・
- 繝・せ繝亥錐: 荳肴・繝医・繧ｯ繝ｳ縺ｯ遨ｺ螻暮幕縺ｨ縺ｪ繧・ - 菴輔ｒ繝・せ繝医☆繧九°: `{unknown}` 縺檎ｩｺ譁・ｭ励↓螻暮幕縺輔ｌ繧・ - 譛溷ｾ・＆繧後ｋ蜍穂ｽ・ 譛ｪ螳夂ｾｩ繧ｭ繝ｼ縺ｯ '' 縺ｫ鄂ｮ謠・ - 蜈･蜉帛､: template='{date}_{unknown}_{idx}', ctx={date:'20240914-120000', idx:2}
  - 蜈･蜉帙ョ繝ｼ繧ｿ縺ｮ諢丞袖: 繝槭ャ繝励↓蟄伜惠縺励↑縺・く繝ｼ
  - 譛溷ｾ・＆繧後ｋ邨先棡: '20240914-120000\_\_2'
  - 譛溷ｾ・ｵ先棡縺ｮ逅・罰: `tokenMap[token] ?? ''`
  - 繝・せ繝医・逶ｮ逧・ 諠ｳ螳壼､悶ヨ繝ｼ繧ｯ繝ｳ譎ゅ・螳牙・蜍穂ｽ・ - 遒ｺ隱阪・繧､繝ｳ繝・ 遨ｺ螻暮幕縺ｨ蜈ｨ菴捺紛蜷・ - 菫｡鬆ｼ諤ｧ: 泙・亥ｮ溯｣・盾辣ｧ・・
- 繝・せ繝亥錐: 遨ｺ縺ｾ縺溘・螳溯ｳｪ遨ｺ邨先棡縺ｯ 'untitled' 繝輔か繝ｼ繝ｫ繝舌ャ繧ｯ
  - 菴輔ｒ繝・せ繝医☆繧九°: 螻暮幕蠕後′遨ｺ/繧｢繝ｳ繝繝ｼ繧ｹ繧ｳ繧｢縺ｮ縺ｿ縺ｧ邨ゅｏ繧句ｴ蜷医・繝輔か繝ｼ繝ｫ繝舌ャ繧ｯ
  - 譛溷ｾ・＆繧後ｋ蜍穂ｽ・ 'untitled' 繧定ｿ斐☆
  - 蜈･蜉帛､: template='{prompt}\_{seed}', ctx={date:'', prompt:'', seed:undefined}
  - 蜈･蜉帙ョ繝ｼ繧ｿ縺ｮ諢丞袖: 縺吶∋縺ｦ遨ｺ縺ｪ縺・＠譛ｪ螳夂ｾｩ
  - 譛溷ｾ・＆繧後ｋ邨先棡: 'untitled'
  - 譛溷ｾ・ｵ先棡縺ｮ逅・罰: `applyFallbackIfEmpty`
  - 繝・せ繝医・逶ｮ逧・ 辟｡蜉ｹ蜷埼亟豁｢
  - 遒ｺ隱阪・繧､繝ｳ繝・ 繝医Μ繝繝ｻ鄂ｮ謠帛ｾ後・遨ｺ蛻､螳・ - 菫｡鬆ｼ諤ｧ: 泙・亥ｮ溯｣・盾辣ｧ・・
- 繝・せ繝亥錐: 遖∵ｭ｢譁・ｭ励′鄂ｮ謠帙＆繧碁｣邯夂ｽｮ謠帙・1譁・ｭ励↓豁｣隕丞喧
  - 菴輔ｒ繝・せ繝医☆繧九°: Windows遖∵ｭ｢譁・ｭ励・鄂ｮ謠帙→騾｣邯夂ｽｮ謠帛・髮・ - 譛溷ｾ・＆繧後ｋ蜍穂ｽ・ `< > : " / \ | ? *` 縺・`_` 縺ｧ鄂ｮ謠帙＆繧後～*\_\_`縺ｯ`*` 縺ｫ蜃晞寔
  - 蜈･蜉帛､: input:'a<b>:\/|?\***c', options:譛ｪ謖・ｮ・ - 蜈･蜉帙ョ繝ｼ繧ｿ縺ｮ諢丞袖: 莉｣陦ｨ逧・ｦ∵ｭ｢髮・粋+騾｣邯夂ｽｮ謠・ - 譛溷ｾ・＆繧後ｋ邨先棡: 'a_b**\_\_\_\_****c' 竊・蜃晞寔蠕・'a_b_c'
  - 譛溷ｾ・ｵ先棡縺ｮ逅・罰: `replaceForbiddenChars` 縺ｨ `consolidateReplacements`
  - 繝・せ繝医・逶ｮ逧・ 繧ｵ繝九ち繧､繧ｺ縺ｮ豁｣遒ｺ諤ｧ
  - 遒ｺ隱阪・繧､繝ｳ繝・ 鄂ｮ謠帛ｾ後・騾｣邯夊ｨ伜捷縺ｮ邵ｮ邏・ - 菫｡鬆ｼ諤ｧ: 泙・亥ｮ溯｣・盾辣ｧ・・
- 繝・せ繝亥錐: 譛ｫ蟆ｾ縺ｮ繝峨ャ繝医→繧ｹ繝壹・繧ｹ縺ｯ蜑企勁
  - 菴輔ｒ繝・せ繝医☆繧九°: 譛ｫ蟆ｾ縺ｮ `. ` 髯､蜴ｻ
  - 譛溷ｾ・＆繧後ｋ蜍穂ｽ・ 'name. ' 竊・'name'
  - 蜈･蜉帛､: input:'name. ', options:譛ｪ謖・ｮ・ - 蜈･蜉帙ョ繝ｼ繧ｿ縺ｮ諢丞袖: Windows邉ｻ縺ｮ蛻ｶ邏・ - 譛溷ｾ・＆繧後ｋ邨先棡: 'name'
  - 譛溷ｾ・ｵ先棡縺ｮ逅・罰: `TRAILING_DOTS_SPACES` 豁｣隕剰｡ｨ迴ｾ
  - 繝・せ繝医・逶ｮ逧・ 繝輔ぃ繧､繝ｫ繧ｷ繧ｹ繝・Β莠呈鋤
  - 遒ｺ隱阪・繧､繝ｳ繝・ 譛ｫ蟆ｾ髯､蜴ｻ縺碁℃荳崎ｶｳ縺ｪ縺・ - 菫｡鬆ｼ諤ｧ: 泙・亥ｮ溯｣・盾辣ｧ・・
- 繝・せ繝亥錐: 譛螟ｧ髟ｷ縺ｧ諡｡蠑ｵ蟄舌ｒ菫晄戟縺励※蛻・ｊ隧ｰ繧・ - 菴輔ｒ繝・せ繝医☆繧九°: `maxLength` 驕ｩ逕ｨ譎ゅ↓諡｡蠑ｵ蟄舌ｒ菫晁ｭｷ
  - 譛溷ｾ・＆繧後ｋ蜍穂ｽ・ 邨先棡髟ｷ=255縲∵忰蟆ｾ縺・`.png`
  - 蜈･蜉帛､: input: 'b'.repeat(300)+'.png', options:{maxLength:255}
  - 蜈･蜉帙ョ繝ｼ繧ｿ縺ｮ諢丞袖: 雜・℃髟ｷ+遏ｭ諡｡蠑ｵ蟄・ - 譛溷ｾ・＆繧後ｋ邨先棡: 髟ｷ縺・55縺ｧ '.png' 菫晄戟
  - 譛溷ｾ・ｵ先棡縺ｮ逅・罰: `truncateWithExtensionPreservation`
  - 繝・せ繝医・逶ｮ逧・ 蛻・ｊ隧ｰ繧∵紛蜷域ｧ
  - 遒ｺ隱阪・繧､繝ｳ繝・ 諡｡蠑ｵ蟄蝉ｽ咲ｽｮ繝ｻ髟ｷ縺墓紛蜷・ - 菫｡鬆ｼ諤ｧ: 泙・亥ｮ溯｣・盾辣ｧ・・
- 繝・せ繝亥錐: forbiddenChars/replace 縺ｮ繧ｫ繧ｹ繧ｿ繝槭う繧ｺ縺悟渚譏縺輔ｌ繧・ - 菴輔ｒ繝・せ繝医☆繧九°: options 縺ｧ鄂ｮ謠帶枚蟄励ｄ遖∵ｭ｢髮・粋繧偵き繧ｹ繧ｿ繝
  - 譛溷ｾ・＆繧後ｋ蜍穂ｽ・ `forbiddenChars:[':','/']` 縺ｨ `replacement:'-'` 縺碁←逕ｨ
  - 蜈･蜉帛､: input:'a:/b', options:{forbiddenChars:[':', '/'], replacement:'-'}
  - 蜈･蜉帙ョ繝ｼ繧ｿ縺ｮ諢丞袖: API縺ｮ譟碑ｻ滓ｧ
  - 譛溷ｾ・＆繧後ｋ邨先棡: 'a--b' 竊・蜃晞寔蠕・'a-b'
  - 譛溷ｾ・ｵ先棡縺ｮ逅・罰: 螳溯｣・・蛻・ｲ・ - 繝・せ繝医・逶ｮ逧・ 譟碑ｻ溯ｨｭ螳壹・螯･蠖捺ｧ
  - 遒ｺ隱阪・繧､繝ｳ繝・ 鄂ｮ謠帛ｾ後・蜃晞寔
  - 菫｡鬆ｼ諤ｧ: 泙・亥ｮ溯｣・盾辣ｧ・・
- 繝・せ繝亥錐: 陦晉ｪ∬ｧ｣豎ｺ繝ｭ繧ｸ繝・け縺悟他縺ｳ蜃ｺ縺輔ｌ邨先棡縺悟､牙喧縺吶ｋ
  - 菴輔ｒ繝・せ繝医☆繧九°: `collisionResolver` 縺悟他縺ｰ繧後∫焚縺ｪ繧句､繧定ｿ泌唆
  - 譛溷ｾ・＆繧後ｋ蜍穂ｽ・ `input` 縺ｨ逡ｰ縺ｪ繧句､縺瑚ｿ斐ｋ・井ｾ・ `_001` 莉倅ｸ趣ｼ・ - 蜈･蜉帛､: input:'name', options:{collisionResolver:(base,i)=> base + '\_' + String(i).padStart(3,'0')}
  - 蜈･蜉帙ョ繝ｼ繧ｿ縺ｮ諢丞袖: 騾｣逡ｪ莉倅ｸ弱・荳闊ｬ萓・ - 譛溷ｾ・＆繧後ｋ邨先棡: 'name_001'
  - 譛溷ｾ・ｵ先棡縺ｮ逅・罰: `resolveCollisions` 縺ｮ譛蛻昴・螟牙喧蛟､縺ｧ霑泌唆
  - 繝・せ繝医・逶ｮ逧・ 繧ｵ繝輔ぅ繝・け繧ｹ逕滓・縺ｮ遒ｺ隱・ - 遒ｺ隱阪・繧､繝ｳ繝・ 繧ｳ繝ｼ繝ｫ蝗樊焚>0縲∫ｵ先棡蟾ｮ蛻・ - 菫｡鬆ｼ諤ｧ: 泙・亥ｮ溯｣・盾辣ｧ・・

## 2. 逡ｰ蟶ｸ邉ｻ繝・せ繝医こ繝ｼ繧ｹ・医お繝ｩ繝ｼ繝上Φ繝峨Μ繝ｳ繧ｰ・・

- 繝・せ繝亥錐: 譛ｪ髢峨§繝悶Ξ繝ｼ繧ｹ縺ｮ繝・Φ繝励Ξ繝ｼ繝医・繧ｨ繝ｩ繝ｼ
  - 繧ｨ繝ｩ繝ｼ繧ｱ繝ｼ繧ｹ縺ｮ讎りｦ・ `'{date}_{prompt'` 縺ｮ繧医≧縺ｪ譛ｪ髢峨§
  - 繧ｨ繝ｩ繝ｼ蜃ｦ逅・・驥崎ｦ∵ｧ: 辟｡髯千ｽｮ謠帙ｄ諢丞峙縺励↑縺・ｵ先棡繧帝亟豁｢
  - 蜈･蜉帛､: template:'{date}\_{prompt', ctx:{date:'20240914-120000', prompt:'test'}
  - 荳肴ｭ｣縺ｪ逅・罰: `UNCLOSED_BRACE` 縺ｫ荳閾ｴ
  - 螳滄圀縺ｮ逋ｺ逕溘す繝翫Μ繧ｪ: 繝・Φ繝励Ξ繝ｼ繝郁ｨｭ螳壹・繧ｿ繧､繝励Α繧ｹ
  - 譛溷ｾ・＆繧後ｋ邨先棡: 萓句､悶′騾∝・
  - 繧ｨ繝ｩ繝ｼ繝｡繝・そ繝ｼ繧ｸ縺ｮ蜀・ｮｹ: 譛ｪ髢峨§繧堤､ｺ蜚・ｼ亥ｮ溯｣・ｾ晏ｭ倥〒OK・・ - 繧ｷ繧ｹ繝・Β縺ｮ螳牙・諤ｧ: 譌ｩ譛溷､ｱ謨励〒螳牙・
  - 繝・せ繝医・逶ｮ逧・ 蜈･蜉帶､懆ｨｼ
  - 蜩∬ｳｪ菫晁ｨｼ縺ｮ隕ｳ轤ｹ: 荳肴ｭ｣險ｭ螳壹・讀懷・
  - 菫｡鬆ｼ諤ｧ: 泙・亥ｮ溯｣・盾辣ｧ・・
- 繝・せ繝亥錐: 髱樊枚蟄怜・繝・Φ繝励Ξ繝ｼ繝医〒繧ｨ繝ｩ繝ｼ
  - 繧ｨ繝ｩ繝ｼ繧ｱ繝ｼ繧ｹ縺ｮ讎りｦ・ `template` 縺・`null` 縺ｪ縺ｩ
  - 繧ｨ繝ｩ繝ｼ蜃ｦ逅・・驥崎ｦ∵ｧ: API螂醍ｴ・・螳・ - 蜈･蜉帛､: template:null as any, ctx:{} as any
  - 荳肴ｭ｣縺ｪ逅・罰: 蝙倶ｸ肴紛蜷・ - 螳滄圀縺ｮ逋ｺ逕溘す繝翫Μ繧ｪ: 險ｭ螳壹・隱ｭ縺ｿ霎ｼ縺ｿ螟ｱ謨・ - 譛溷ｾ・＆繧後ｋ邨先棡: 萓句､・ - 繧ｨ繝ｩ繝ｼ繝｡繝・そ繝ｼ繧ｸ縺ｮ蜀・ｮｹ: 譁・ｭ怜・隕∵ｱ・ - 繧ｷ繧ｹ繝・Β縺ｮ螳牙・諤ｧ: 譌ｩ譛溷､ｱ謨・ - 繝・せ繝医・逶ｮ逧・ 蝙九ヰ繝ｪ繝・・繧ｷ繝ｧ繝ｳ
  - 蜩∬ｳｪ菫晁ｨｼ縺ｮ隕ｳ轤ｹ: 荳肴ｭ｣蜈･蜉帙ぎ繝ｼ繝・ - 菫｡鬆ｼ諤ｧ: 泙・亥ｮ溯｣・盾辣ｧ・・
- 繝・せ繝亥錐: 蜈･蜉幃聞縺後そ繧ｭ繝･繝ｪ繝・ぅ荳企剞繧定ｶ・∴繧九→繧ｨ繝ｩ繝ｼ
  - 繧ｨ繝ｩ繝ｼ繧ｱ繝ｼ繧ｹ縺ｮ讎りｦ・ 髱槫ｸｸ縺ｫ髟ｷ縺・ユ繝ｳ繝励Ξ繝ｼ繝・蜈･蜉・ - 繧ｨ繝ｩ繝ｼ蜃ｦ逅・・驥崎ｦ∵ｧ: DoS蝗樣∩
  - 蜈･蜉帛､: template:'a'.repeat(10001), ctx:{prompt:'x'} 縺ｾ縺溘・ sanitize input: 'a'.repeat(10001)
  - 荳肴ｭ｣縺ｪ逅・罰: `MAX_INPUT_LENGTH(10000)` 雜・℃
  - 螳滄圀縺ｮ逋ｺ逕溘す繝翫Μ繧ｪ: 隱､險ｭ螳壹ｄ螟夜Κ蜈･蜉・ - 譛溷ｾ・＆繧後ｋ邨先棡: 萓句､・ - 繧ｨ繝ｩ繝ｼ繝｡繝・そ繝ｼ繧ｸ縺ｮ蜀・ｮｹ: 荳企剞雜・℃
  - 繧ｷ繧ｹ繝・Β縺ｮ螳牙・諤ｧ: 險育ｮ苓ｳ・ｺ舌・菫晁ｭｷ
  - 繝・せ繝医・逶ｮ逧・ 荳企剞驕ｩ逕ｨ
  - 蜩∬ｳｪ菫晁ｨｼ縺ｮ隕ｳ轤ｹ: 謔ｪ逕ｨ蟇ｾ遲・ - 菫｡鬆ｼ諤ｧ: 泙・亥ｮ溯｣・盾辣ｧ・・
- 繝・せ繝亥錐: `maxLength<=0` 縺ｮ繧ｪ繝励す繝ｧ繝ｳ縺ｯ繧ｨ繝ｩ繝ｼ
  - 繧ｨ繝ｩ繝ｼ繧ｱ繝ｼ繧ｹ縺ｮ讎りｦ・ 辟｡蜉ｹ縺ｪ蛻ｶ邏・ - 繧ｨ繝ｩ繝ｼ蜃ｦ逅・・驥崎ｦ∵ｧ: 荳肴ｭ｣險ｭ螳壹・譌ｩ譛滓､懷・
  - 蜈･蜉帛､: sanitize input:'abc', options:{maxLength:0}
  - 荳肴ｭ｣縺ｪ逅・罰: 繧ｬ繝ｼ繝画擅莉ｶ荳閾ｴ
  - 螳滄圀縺ｮ逋ｺ逕溘す繝翫Μ繧ｪ: 繝ｦ繝ｼ繧ｶ繝ｼ縺ｮ隱､險ｭ螳・ - 譛溷ｾ・＆繧後ｋ邨先棡: 萓句､・ - 繧ｨ繝ｩ繝ｼ繝｡繝・そ繝ｼ繧ｸ縺ｮ蜀・ｮｹ: 1莉･荳翫ｒ隕∵ｱ・ - 繧ｷ繧ｹ繝・Β縺ｮ螳牙・諤ｧ: 荳肴ｭ｣迥ｶ諷句屓驕ｿ
  - 繝・せ繝医・逶ｮ逧・ 繧ｪ繝励す繝ｧ繝ｳ讀懆ｨｼ
  - 蜩∬ｳｪ菫晁ｨｼ縺ｮ隕ｳ轤ｹ: API蝣・欧諤ｧ
  - 菫｡鬆ｼ諤ｧ: 泙・亥ｮ溯｣・盾辣ｧ・・

## 3. 蠅・阜蛟､繝・せ繝医こ繝ｼ繧ｹ・域怙蟆丞､縲∵怙螟ｧ蛟､縲］ull遲会ｼ・

- 繝・せ繝亥錐: 縺｡繧・≧縺ｩ `maxLength` 縺ｮ蝣ｴ蜷医・蛻・ｊ隧ｰ繧√↑縺・ - 蠅・阜蛟､縺ｮ諢丞袖: 遲牙捷蠅・阜縺ｮ謖ｯ繧玖・縺・ - 蠅・阜蛟､縺ｧ縺ｮ蜍穂ｽ應ｿ晁ｨｼ: 荳崎ｦ√↑蛻・ｊ隧ｰ繧√↑縺・ - 蜈･蜉帛､: input:'a'.repeat(255), options:{maxLength:255}
  - 蠅・阜蛟､驕ｸ謚槭・譬ｹ諡: 莉墓ｧ倅ｸ企剞
  - 螳滄圀縺ｮ菴ｿ逕ｨ蝣ｴ髱｢: 髟ｷ縺・・繝ｭ繝ｳ繝励ヨ
  - 譛溷ｾ・＆繧後ｋ邨先棡: 縺昴・縺ｾ縺ｾ霑泌唆
  - 蠅・阜縺ｧ縺ｮ豁｣遒ｺ諤ｧ: 髟ｷ縺穂ｸ榊､・ - 荳雋ｫ縺励◆蜍穂ｽ・ 255竊・55
  - 繝・せ繝医・逶ｮ逧・ 遲牙捷蠅・阜
  - 蝣・欧諤ｧ縺ｮ遒ｺ隱・ 辟｡鬧・↑螟画峩縺ｪ縺・ - 菫｡鬆ｼ諤ｧ: 泙・亥ｮ溯｣・盾辣ｧ・・
- 繝・せ繝亥錐: `maxLength` 繧・縺縺題ｶ・∴縺溷ｴ蜷医・蛻・ｊ隧ｰ繧・ - 蠅・阜蛟､縺ｮ諢丞袖: 雜・℃譛蟆上こ繝ｼ繧ｹ
  - 蠅・阜蛟､縺ｧ縺ｮ蜍穂ｽ應ｿ晁ｨｼ: 1譁・ｭ励・縺ｿ蜑頑ｸ幢ｼ域僑蠑ｵ蟄舌↑縺暦ｼ・ - 蜈･蜉帛､: input:'a'.repeat(256), options:{maxLength:255}
  - 蠅・阜蛟､驕ｸ謚槭・譬ｹ諡: 255+1
  - 螳滄圀縺ｮ菴ｿ逕ｨ蝣ｴ髱｢: 諠ｳ螳壼､冶ｶ・℃
  - 譛溷ｾ・＆繧後ｋ邨先棡: 髟ｷ縺・55
  - 蠅・阜縺ｧ縺ｮ豁｣遒ｺ諤ｧ: 蜈磯ｭ菫晄戟
  - 荳雋ｫ縺励◆蜍穂ｽ・ 繝医Μ繝溘Φ繧ｰ縺ｮ縺ｿ
  - 繝・せ繝医・逶ｮ逧・ 譛蟆剰ｶ・℃
  - 蝣・欧諤ｧ縺ｮ遒ｺ隱・ 螳牙ｮ壼・繧願ｩｰ繧・ - 菫｡鬆ｼ諤ｧ: 泙・亥ｮ溯｣・盾辣ｧ・・
- 繝・せ繝亥錐: 諡｡蠑ｵ蟄宣聞縺碁明蛟､繧定ｶ・∴繧句ｴ蜷医・諡｡蠑ｵ蟄舌ｒ菫晄戟縺励↑縺・ - 蠅・阜蛟､縺ｮ諢丞袖: 螳溯｣・・譚｡莉ｶ `lastDotIndex > input.length - 10`
  - 蠅・阜蛟､縺ｧ縺ｮ蜍穂ｽ應ｿ晁ｨｼ: 髟ｷ縺・僑蠑ｵ蟄舌・髱樔ｿ晄戟繝ｫ繝ｼ繝医∈
  - 蜈･蜉帛､: input:'a'.repeat(260)+'.verylongext', options:{maxLength:255}
  - 蠅・阜蛟､驕ｸ謚槭・譬ｹ諡: 諡｡蠑ｵ蟄宣聞>9
  - 螳滄圀縺ｮ菴ｿ逕ｨ蝣ｴ髱｢: 逡ｰ蟶ｸ縺ｪ諡｡蠑ｵ蟄・ - 譛溷ｾ・＆繧後ｋ邨先棡: 蜈磯ｭ縺九ｉ255縺ｸ蜊倡ｴ泌・繧願ｩｰ繧・ - 蠅・阜縺ｧ縺ｮ豁｣遒ｺ諤ｧ: 譚｡莉ｶ蛻・ｲ舌・邯ｲ鄒・ - 荳雋ｫ縺励◆蜍穂ｽ・ 髱樔ｿ晄戟繝代せ縺ｮ遒ｺ隱・ - 繝・せ繝医・逶ｮ逧・ 譚｡莉ｶ蛻・ｲ仙｢・阜
  - 蝣・欧諤ｧ縺ｮ遒ｺ隱・ 螳牙・縺ｪ邨先棡
  - 菫｡鬆ｼ諤ｧ: 泙・亥ｮ溯｣・盾辣ｧ・・
- 繝・せ繝亥錐: `idx=0` 縺ｮ蝣ｴ蜷医・繝・ヵ繧ｩ繝ｫ繝・縺ｸ・・alsy蠅・阜・・ - 蠅・阜蛟､縺ｮ諢丞袖: `0` 縺ｯ falsy 縺ｮ縺溘ａ譌｢螳壼､縺ｫ關ｽ縺｡繧・ - 蠅・阜蛟､縺ｧ縺ｮ蜍穂ｽ應ｿ晁ｨｼ: '0' 繧定ｨｱ螳ｹ縺励↑縺・樟螳溯｣・・謖吝虚繧貞崋螳・ - 蜈･蜉帛､: template:'{idx}', ctx:{idx:0, date:'d', prompt:'p'}
  - 蠅・阜蛟､驕ｸ謚槭・譬ｹ諡: 0 縺ｯ隕∵ｳｨ諢丞､
  - 螳滄圀縺ｮ菴ｿ逕ｨ蝣ｴ髱｢: 騾｣逡ｪ襍ｷ轤ｹ縺壹ｌ
  - 譛溷ｾ・＆繧後ｋ邨先棡: '1'
  - 蠅・阜縺ｧ縺ｮ豁｣遒ｺ諤ｧ: 莉墓ｧ倬壹ｊ・育樟陦後さ繝ｼ繝会ｼ・ - 荳雋ｫ縺励◆蜍穂ｽ・ 0竊・
  - 繝・せ繝医・逶ｮ逧・ falsy蠅・阜縺ｮ譏守｢ｺ蛹・ - 蝣・欧諤ｧ縺ｮ遒ｺ隱・ 譛溷ｾ・・蝗ｺ螳壼喧
  - 菫｡鬆ｼ諤ｧ: 泙・亥ｮ溯｣・盾辣ｧ・・
- 繝・せ繝亥錐: 鄂ｮ謠帛ｾ後・騾｣邯夊ｨ伜捷邵ｮ邏・・蠅・阜
  - 蠅・阜蛟､縺ｮ諢丞袖: 鄂ｮ謠帚・邵ｮ邏・・譛蟆丞､画鋤
  - 蠅・阜蛟､縺ｧ縺ｮ蜍穂ｽ應ｿ晁ｨｼ: '\__' 竊・'_'
  - 蜈･蜉帛､: input:'a\_\_b', options:譛ｪ謖・ｮ・ - 蠅・阜蛟､驕ｸ謚槭・譬ｹ諡: 2騾｣邯・ - 螳滄圀縺ｮ菴ｿ逕ｨ蝣ｴ髱｢: 螟夊ｨ伜捷逕滓・
  - 譛溷ｾ・＆繧後ｋ邨先棡: 'a_b'
  - 蠅・阜縺ｧ縺ｮ豁｣遒ｺ諤ｧ: 蜃晞寔豁｣遒ｺ
  - 荳雋ｫ縺励◆蜍穂ｽ・ n騾｣邯壺・1
  - 繝・せ繝医・逶ｮ逧・ 豁｣隕丞喧蠅・阜
  - 蝣・欧諤ｧ縺ｮ遒ｺ隱・ 蜿ｯ隱ｭ蜷阪・邯ｭ謖・ - 菫｡鬆ｼ諤ｧ: 泙・亥ｮ溯｣・盾辣ｧ・・

---

## 髢狗匱險隱槭・繝輔Ξ繝ｼ繝繝ｯ繝ｼ繧ｯ

- 繝励Ο繧ｰ繝ｩ繝溘Φ繧ｰ險隱・ TypeScript
  - 險隱樣∈謚槭・逅・罰: 譌｢蟄伜ｮ溯｣・→繝・せ繝医′TS縺ｧ邨ｱ荳縲∝梛縺ｧ螂醍ｴ・ｒ譏守｢ｺ蛹・ - 繝・せ繝医↓驕ｩ縺励◆讖溯・: 蝙玖｣懷ｮ後・SM蟇ｾ蠢懊√ヰ繝ｳ繝峨Λ荳崎ｦ・ - 菫｡鬆ｼ諤ｧ: 泙・医Μ繝昴ず繝医Μ讒区・縺ｨ螳溯｣・盾辣ｧ・・
- 繝・せ繝医ヵ繝ｬ繝ｼ繝繝ｯ繝ｼ繧ｯ: Vitest
  - 繝輔Ξ繝ｼ繝繝ｯ繝ｼ繧ｯ驕ｸ謚槭・逅・罰: 譌｢蟄倥・ `vitest.config.ts` 縺ｨ `*.test.ts` 繧定ｸ剰･ｲ
  - 繝・せ繝亥ｮ溯｡檎腸蠅・ Node + jsdom・亥ｿ・ｦ√↓蠢懊§縺ｦ・・ - 菫｡鬆ｼ諤ｧ: 泙・域里蟄倥ユ繧ｹ繝・險ｭ螳壼盾辣ｧ・・

---

## 繝・せ繝医こ繝ｼ繧ｹ螳溯｣・凾縺ｮ譌･譛ｬ隱槭さ繝｡繝ｳ繝域欠驥晢ｼ亥ｿ・茨ｼ・

蜷・ユ繧ｹ繝医↓縺ｯ谺｡縺ｮ繧ｳ繝｡繝ｳ繝医ヶ繝ｭ繝・け繧貞性繧√ｋ縺薙→縲・

```javascript
// 縲舌ユ繧ｹ繝育岼逧・・ 菴輔ｒ遒ｺ隱阪☆繧九°
// 縲舌ユ繧ｹ繝亥・螳ｹ縲・ 螳溯｡悟・逅・・隱ｬ譏・// 縲先悄蠕・＆繧後ｋ蜍穂ｽ懊・ 豁｣蟶ｸ蜍穂ｽ懈凾縺ｮ邨先棡
// 泙泯閥 縺薙・蜀・ｮｹ縺ｮ菫｡鬆ｼ諤ｧ繝ｬ繝吶Ν
```

## Given/When/Then縲∝推 expect縲｜eforeEach/afterEach 繧りｦ∵ｱる壹ｊ縺ｫ險倩ｿｰ縺吶ｋ縺薙→縲・

## 蜩∬ｳｪ蛻､螳・

笨・鬮伜刀雉ｪ・郁・蟾ｱ隧穂ｾ｡・・- 繝・せ繝医こ繝ｼ繧ｹ蛻・｡・ 豁｣蟶ｸ邉ｻ繝ｻ逡ｰ蟶ｸ邉ｻ繝ｻ蠅・阜蛟､繧堤ｶｲ鄒・- 譛溷ｾ・､螳夂ｾｩ: 蜷・ユ繧ｹ繝医〒蜈ｷ菴鍋噪縺ｪ譛溷ｾ・､繧呈・險・- 謚陦馴∈謚・ TypeScript + Vitest 縺ｫ遒ｺ螳・- 螳溯｣・庄閭ｽ諤ｧ: 譌｢蟄倥せ繧ｿ繝・け縺ｫ蜷郁・縺励∝叉譎ょｮ溯｣・庄閭ｽ

---

## 谺｡縺ｮ繧ｹ繝・ャ繝・

谺｡縺ｮ縺雁匡繧√せ繝・ャ繝・ `/tdd-red file-name-template-sanitization` 縺ｧRed繝輔ぉ繝ｼ繧ｺ・亥､ｱ謨励ユ繧ｹ繝井ｽ懈・・峨ｒ髢句ｧ九＠縺ｾ縺吶・
