# kairo-design

## 目的
要件定義書を基に、技術設計文書を作成する。アーキテクチャ、データ構造、API設計、セキュリティ設計を含む包括的な設計文書を生成する。

## 前提条件
- 要件定義書が存在する
- `docs/design/` ディレクトリが存在する（なければ作成）

## 実行内容

1. **要件分析**
   - 要件定義書を読み込み、機能要件と非機能要件を分析
   - 技術的制約とビジネス制約を特定

2. **アーキテクチャ設計**
   - システム全体のアーキテクチャを設計
   - コンポーネント間の依存関係を定義
   - データフローを設計

3. **詳細設計**
   - 各コンポーネントの詳細設計
   - データ構造の定義
   - API設計（エンドポイント、リクエスト/レスポンス形式）

4. **セキュリティ設計**
   - 認証・認可の仕組み
   - データ保護の方法
   - セキュリティリスクの評価

5. **ファイルの作成**
   - `docs/design/{機能名}-design.md` として保存
   - マークダウン形式で構造化された文書を作成

## 出力フォーマット例

```markdown
# {機能名} 技術設計書

## 概要
{機能の概要と設計方針}

## アーキテクチャ

### システム全体構成
- コンポーネント図
- データフロー図
- 依存関係図

### 技術スタック
- フロントエンド: {技術}
- バックエンド: {技術}
- データベース: {技術}
- インフラ: {技術}

## 詳細設計

### コンポーネント設計
#### {コンポーネント名}
- 責務: {責務の説明}
- インターフェース: {公開API}
- 依存関係: {依存するコンポーネント}

### データ構造
#### {データ構造名}
```json
{
  "field1": "type",
  "field2": "type"
}
```

### API設計
#### {エンドポイント名}
- URL: `{HTTPメソッド} /{パス}`
- リクエスト: {リクエスト形式}
- レスポンス: {レスポンス形式}
- エラー: {エラーケース}

## セキュリティ設計

### 認証・認可
- 認証方式: {認証方法}
- 認可モデル: {認可の仕組み}

### データ保護
- 暗号化: {暗号化方式}
- データマスキング: {マスキング方法}

### セキュリティリスク
- リスク1: {リスク内容と対策}
- リスク2: {リスク内容と対策}

## パフォーマンス設計

### スケーラビリティ
- 水平スケーリング: {方法}
- 垂直スケーリング: {方法}

### 最適化
- キャッシュ戦略: {キャッシュ方法}
- データベース最適化: {最適化方法}

## 運用設計

### 監視・ログ
- 監視項目: {監視する指標}
- ログレベル: {ログの設定}

### デプロイメント
- デプロイ戦略: {デプロイ方法}
- ロールバック: {ロールバック手順}

## 実装ガイドライン

### コーディング規約
- 命名規則: {命名規則}
- コメント規約: {コメントの書き方}

### テスト戦略
- 単体テスト: {テスト方法}
- 統合テスト: {テスト方法}
- E2Eテスト: {テスト方法}
```

## 実行後の確認
- 作成したファイルのパスを表示
- 設計の主要なポイントを要約
- 実装時の注意点を提示
